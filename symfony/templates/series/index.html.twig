{% extends 'base.html.twig' %}

{% block title %}Series{% endblock %}

{% block body %}
    <div class="bg-black">
        <div class="container mx-auto py-8">
            <h1 class="text-4xl text-white font-bold mb-8">Series</h1>

            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-8">
                {% for series in series %}
                    <div class="flex justify-between flex-col transform transition-transform duration-300 hover:scale-105 bg-gray-900 rounded-lg hover:border-red-500 border-2 border-transparent h-full">
                        <a href="{{ path('app_series_show', {'id': series.id}) }}">
                            <img src="{{ path('app_series_poster', {'id': series.id }) }}" alt="{{ series.title }}" class="w-full h-fit object-cover rounded-t-lg">
                            <div class="p-4">
                                    <h2 class="text-white text-xl font-bold mb-2">{{ series.title }}</h2>
                                    <p class="text-white mb-2">Seasons: {{ series.seasons|length }}</p>
                                    {% for genre in series.genres %}
                                        <span class="inline-block bg-gray-800 rounded-full px-3 py-1 text-sm font-semibold text-gray-300 mr-2 mb-2">{{ genre.name }}</span>
                                    {% endfor %}
                                    <p class="text-white mb-2">Year: {{ series.yearStart }} - {% if series.yearEnd is null %}present{% else %}{{ series.yearEnd }}{% endif %}</p>
                            </div>
                        </a>
                        {% if user %}
                                {% if series in user.series %}
                                    <div class = "flex justify-center pb-4 pt-2 bg-red-600 rounded-b-lg font-bold">
                                    <form action="{{ path('app_series_unfollow', {'id': series.id,'page': current_page}) }}" method="post" class = "w-full h-full">
                                        <button type="submit" class="text-white hover:text-gray-300 w-full h-full">Unfollow</button>
                                    </form>
                                    </div>
                                {% else %}
                                    <div class = "flex justify-center pb-4 pt-2 bg-green-600 rounded-b-lg font-bold">
                                    <form action="{{ path('app_series_follow', {'id': series.id,'page': current_page}) }}" method="post" class = "w-full h-full">
                                        <button type="submit" class="text-white hover:text-gray-300 w-full h-full">Follow</button>
                                    </form>
                                    </div>
                                {% endif %}
                            {% endif %}
                    </div>
                {% else %}
                    <p class="text-gray-700">No records found</p>
                {% endfor %}
            </div>

            <div class="flex justify-center mt-8">
                {% set prev_page = current_page - 1 %}
                {% set next_page = current_page + 1 %}

                {% if prev_page > 0 %}
                    <a href="{{ path(app_action, {'page': prev_page}) }}" class="text-white hover:text-gray-300 mr-4">Previous</a>
                {% endif %}

                {% for page in 1..totalPages %}
                    {% if page == current_page %}
                        <span class="text-white bg-red-500 rounded-full font-bold px-5">{{ page }}</span>
                    {% else %}
                        <a href="{{ path(app_action, {'page': page}) }}" class="text-white hover:text-gray-300 px-5">{{ page }}</a>
                    {% endif %}
                {% endfor %}

                {% if next_page <= totalPages %}
                    <a href="{{ path(app_action, {'page': next_page}) }}" class="text-white hover:text-gray-300 pl-5">Next</a>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}